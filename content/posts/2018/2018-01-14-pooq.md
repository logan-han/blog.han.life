---
title: "Pooq Proxy"
date: "2018-01-14"
---

This is my current setup for watching Pooq in Australia for anyone interested. With local proxy, below 4k streaming (UHD) seems alright with NBN via AussieBB. TPG might have better throughput as they have [PPC-1](https://en.wikipedia.org/wiki/Pipe_Pacific_Cable) submarine cable.

**Architecture Diagram** [![](images/Untitled-Diagram.png)](https://blog.han.life/wp-content/uploads/2018/01/Untitled-Diagram.png)

**Prerequisite** 1. Nginx installed host in Korea - AWS LightSail costs USD 3.5/month~ 2. DNS dmasquerading - this can be any dns server running from your router or NAS 3. Pooq subscription - Can be paid via Korean credit card or Apple store credit

**Dnsmasq Config**

\[bash\]address=/live-su.cdn.pooq.co.kr/vod-su.cdn.pooq.co.kr/\_put current IP address of the host here to exclude them from the below\_
address=/.cdn.pooq.co.kr/\_your Nginx host IP here\_\[/bash\]

**Nginx Config**

\[bash\]
 server {
    server\_name apis.pooq.co.kr ;
    listen 80;

    location / {
      proxy\_set\_header Host $host;
      proxy\_pass http://apis.pooq.co.kr;
    }
  }

 server {
    server\_name ~^(.\*)\\.cdn\\.wavve\\.com$ ;
    listen 80;

    location / {
      proxy\_set\_header Host $host;
      proxy\_pass http://vod-m02.cdn.wavve.com;
    }
  }

 server {
    server\_name ~^(.\*)\\.cdn\\.pooq\\.co\\.kr$ ;
    listen 80;

    location / {
      proxy\_set\_header Host $host;
      proxy\_pass http://vod-m02.cdn.pooq.co.kr;
    }
  }

  server {
    server\_name ~^api\\.tving\\.com$ ;
    listen 80;

    location / {
      proxy\_set\_header Host $host;
      proxy\_pass http://api.tving.com;
    }
  }

  server {
    server\_name pip-vod-xcdn.tving.com ;
    listen 80;

    location / {
      proxy\_set\_header Host $host;
      proxy\_pass http://pip-vod-xcdn.tving.com;
    }
  }

}

stream {
  map $ssl\_preread\_server\_name $selected\_upstream {
    api.tving.com tving\_api;
    apis.pooq.co.kr pooq\_api;
     ~^(.\*)\\.cdn\\.pooq\\.co\\.kr$ pooq\_cdn;
    ~^(.\*)\\.cdn\\.wavve\\.com$ wavve\_cdn;
  }
  upstream tving\_api { server api.tving.com:443; }
  upstream pooq\_api { server apis.pooq.co.kr:443; }
  upstream pooq\_cdn { server vod-m02.cdn.pooq.co.kr:443; }
  upstream wavve\_cdn { server vod-m02.cdn.wavve.com:443; }

  server {
    listen 443;
    proxy\_pass $selected\_upstream;
    ssl\_preread on;
  }
}

\[/bash\]

Note: need libnginx-mod-stream package installed

**(Optional) Pooq Local Proxy** [https://github.com/logan-han/pooq-proxy](https://github.com/logan-han/pooq-proxy) Need to reroute \*.cdn.pooq.co.kr traffic to the proxy using DNS server. Don't forget to set config.js file to point the nginx host.
